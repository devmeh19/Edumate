{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\asus\\\\OneDrive\\\\Desktop\\\\autom\\\\client\\\\src\\\\components\\\\assessment\\\\LevelBasedAssessment.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LevelBasedAssessment = () => {\n  _s();\n  const {\n    classId,\n    studentId\n  } = useParams();\n  const navigate = useNavigate();\n  const [currentLevel, setCurrentLevel] = useState(1);\n  const [isRecording, setIsRecording] = useState(false);\n  const [transcript, setTranscript] = useState('');\n  const [expectedAnswer, setExpectedAnswer] = useState('');\n  const [accuracy, setAccuracy] = useState(null);\n  const [showAccuracy, setShowAccuracy] = useState(false);\n  const [error, setError] = useState('');\n  const [isSaving, setIsSaving] = useState(false);\n  const [progress, setProgress] = useState({\n    story: {\n      completed: false,\n      accuracy: 0\n    },\n    poem: {\n      completed: false,\n      accuracy: 0\n    },\n    sentence: {\n      completed: false,\n      accuracy: 0\n    },\n    words: {\n      completed: false,\n      accuracy: 0\n    },\n    letter: {\n      completed: false,\n      accuracy: 0\n    }\n  });\n  const recognitionRef = useRef(null);\n  const levels = [{\n    id: 1,\n    name: 'Story',\n    description: 'Read a short story'\n  }, {\n    id: 2,\n    name: 'Poem',\n    description: 'Recite a poem'\n  }, {\n    id: 3,\n    name: 'Sentence',\n    description: 'Read a sentence'\n  }, {\n    id: 4,\n    name: 'Words',\n    description: 'Read individual words'\n  }, {\n    id: 5,\n    name: 'Letter',\n    description: 'Read individual letters'\n  }];\n\n  // Speech Recognition Setup\n  const startSpeechRecognition = () => {\n    if ('webkitSpeechRecognition' in window) {\n      const recognition = new window.webkitSpeechRecognition();\n      recognitionRef.current = recognition;\n      recognition.continuous = true;\n      recognition.interimResults = true;\n      recognition.onresult = event => {\n        const current = event.resultIndex;\n        const transcript = event.results[current][0].transcript;\n        setTranscript(transcript);\n      };\n      recognition.onerror = event => {\n        setError('Speech recognition error: ' + event.error);\n      };\n      recognition.start();\n      setIsRecording(true);\n    } else {\n      setError('Speech recognition is not supported in your browser');\n    }\n  };\n  const stopSpeechRecognition = () => {\n    if (recognitionRef.current) {\n      recognitionRef.current.stop();\n      setIsRecording(false);\n    }\n  };\n  const calculateAccuracy = (expected, actual) => {\n    console.log('Calculating accuracy:', {\n      expected,\n      actual\n    });\n    if (!expected || !actual) return 0;\n\n    // Clean and normalize the texts\n    const cleanExpected = expected.toLowerCase().trim().replace(/[^a-z0-9\\s]/g, '');\n    const cleanActual = actual.toLowerCase().trim().replace(/[^a-z0-9\\s]/g, '');\n\n    // Split into words and remove empty strings\n    const expectedWords = cleanExpected.split(/\\s+/).filter(word => word.length > 0);\n    const actualWords = cleanActual.split(/\\s+/).filter(word => word.length > 0);\n    console.log('Cleaned expected words:', expectedWords);\n    console.log('Cleaned actual words:', actualWords);\n\n    // Count matching words\n    let matches = 0;\n    expectedWords.forEach(expectedWord => {\n      // Check for exact matches first\n      if (actualWords.includes(expectedWord)) {\n        matches++;\n      } else {\n        // Check for partial matches\n        const partialMatch = actualWords.some(actualWord => {\n          const similarity = calculateSimilarity(expectedWord, actualWord);\n          return similarity > 0.8;\n        });\n        if (partialMatch) {\n          matches++;\n        }\n      }\n    });\n    const accuracy = matches / expectedWords.length * 100;\n    console.log('Accuracy calculated:', accuracy);\n    return Math.round(accuracy);\n  };\n  const calculateSimilarity = (str1, str2) => {\n    if (str1.length === 0 || str2.length === 0) return 0;\n    const matrix = Array(str1.length + 1).fill().map(() => Array(str2.length + 1).fill(0));\n    for (let i = 0; i <= str1.length; i++) {\n      matrix[i][0] = i;\n    }\n    for (let j = 0; j <= str2.length; j++) {\n      matrix[0][j] = j;\n    }\n    for (let i = 1; i <= str1.length; i++) {\n      for (let j = 1; j <= str2.length; j++) {\n        const cost = str1[i - 1] === str2[j - 1] ? 0 : 1;\n        matrix[i][j] = Math.min(matrix[i - 1][j] + 1, matrix[i][j - 1] + 1, matrix[i - 1][j - 1] + cost);\n      }\n    }\n    const distance = matrix[str1.length][str2.length];\n    const maxLength = Math.max(str1.length, str2.length);\n    return 1 - distance / maxLength;\n  };\n  const handleEvaluate = () => {\n    console.log('Evaluating assessment...');\n    console.log('Expected Answer:', expectedAnswer);\n    console.log('Transcript:', transcript);\n    if (!expectedAnswer || !transcript) {\n      setError('Please provide both expected answer and student response');\n      return;\n    }\n    const calculatedAccuracy = calculateAccuracy(expectedAnswer, transcript);\n    console.log('Setting accuracy:', calculatedAccuracy);\n    setAccuracy(calculatedAccuracy);\n    setShowAccuracy(true);\n    setError('');\n\n    // Update progress if accuracy is above threshold\n    if (calculatedAccuracy >= 33) {\n      const levelName = levels[currentLevel - 1].name.toLowerCase();\n      setProgress(prev => ({\n        ...prev,\n        [levelName]: {\n          completed: true,\n          accuracy: calculatedAccuracy\n        }\n      }));\n\n      // Unlock next level if available\n      if (currentLevel < levels.length) {\n        setCurrentLevel(prev => prev + 1);\n      }\n    }\n  };\n  const handleSave = async () => {\n    if (!accuracy && accuracy !== 0) {\n      setError('Please evaluate the assessment before saving');\n      return;\n    }\n    if (!expectedAnswer || !transcript) {\n      setError('Please provide both expected answer and student response');\n      return;\n    }\n    setIsSaving(true);\n    try {\n      // Get current level name\n      const currentLevelName = levels[currentLevel - 1].name;\n\n      // Ensure progress data is properly formatted\n      const formattedProgress = {\n        story: progress.story || {\n          completed: false,\n          accuracy: 0\n        },\n        poem: progress.poem || {\n          completed: false,\n          accuracy: 0\n        },\n        sentence: progress.sentence || {\n          completed: false,\n          accuracy: 0\n        },\n        words: progress.words || {\n          completed: false,\n          accuracy: 0\n        },\n        letter: progress.letter || {\n          completed: false,\n          accuracy: 0\n        }\n      };\n      const assessmentData = {\n        type: 'level-based',\n        levelName: currentLevelName,\n        levelNumber: currentLevel,\n        expectedAnswer,\n        transcript,\n        accuracy,\n        currentLevel,\n        progress: formattedProgress,\n        date: new Date()\n      };\n      console.log('Saving assessment with data:', assessmentData);\n      const res = await axios.post(`/api/classes/${classId}/students/${studentId}/assessment`, assessmentData, {\n        withCredentials: true,\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      console.log('Assessment saved successfully:', res.data);\n      navigate(`/class/${classId}/student/${studentId}/assessments`);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error('Error saving assessment:', err);\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.msg) || 'Failed to save assessment');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto px-4 py-8\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-4xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-3xl font-bold\",\n          children: \"Level-Based Assessment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigate(-1),\n          className: \"px-4 py-2 text-gray-600 hover:text-gray-800\",\n          children: \"\\u2190 Back\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded mb-4\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-md p-6 mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold mb-4\",\n          children: \"Level Progress\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: levels.map(level => {\n            var _progress$level$name$;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `p-4 rounded-lg border ${level.id === currentLevel ? 'border-indigo-500 bg-indigo-50' : level.id < currentLevel ? 'border-green-500 bg-green-50' : 'border-gray-200 bg-gray-50'}`,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"font-medium\",\n                    children: level.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 260,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-gray-600\",\n                    children: level.description\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 261,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-right\",\n                  children: [level.id < currentLevel ? /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-green-600\",\n                    children: \"Completed\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 265,\n                    columnNumber: 23\n                  }, this) : level.id === currentLevel ? /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-indigo-600\",\n                    children: \"Current Level\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 267,\n                    columnNumber: 23\n                  }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-gray-500\",\n                    children: \"Locked\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 269,\n                    columnNumber: 23\n                  }, this), ((_progress$level$name$ = progress[level.name.toLowerCase()]) === null || _progress$level$name$ === void 0 ? void 0 : _progress$level$name$.accuracy) > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm\",\n                    children: [\"Accuracy: \", progress[level.name.toLowerCase()].accuracy, \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 272,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 263,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 17\n              }, this)\n            }, level.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 15\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-md p-6 mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-semibold mb-4\",\n          children: [\"Level \", currentLevel, \": \", levels[currentLevel - 1].name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Expected Answer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: expectedAnswer,\n            onChange: e => setExpectedAnswer(e.target.value),\n            className: \"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\",\n            rows: \"3\",\n            placeholder: \"Enter the expected answer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Student's Response\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-4 mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: isRecording ? stopSpeechRecognition : startSpeechRecognition,\n              className: `px-4 py-2 rounded-md ${isRecording ? 'bg-red-600 hover:bg-red-700' : 'bg-indigo-600 hover:bg-indigo-700'} text-white`,\n              children: isRecording ? 'Stop Recording' : 'Start Recording'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 15\n            }, this), isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-3 h-3 bg-red-600 rounded-full animate-pulse mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 319,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-600\",\n                children: \"Recording...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: transcript,\n            onChange: e => setTranscript(e.target.value),\n            className: \"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\",\n            rows: \"3\",\n            placeholder: \"Student's response will appear here\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleEvaluate,\n            className: \"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500\",\n            children: \"Evaluate Assessment\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 13\n          }, this), showAccuracy && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-right\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg font-medium\",\n              children: [\"Accuracy: \", accuracy, \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-32 bg-gray-200 rounded-full h-2.5 mt-1\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-indigo-600 h-2.5 rounded-full\",\n                style: {\n                  width: `${accuracy}%`\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 9\n      }, this), showAccuracy && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-end\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSave,\n          disabled: isSaving,\n          className: `px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 ${isSaving ? 'opacity-50 cursor-not-allowed' : ''}`,\n          children: isSaving ? 'Saving...' : 'Save Assessment'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 225,\n    columnNumber: 5\n  }, this);\n};\n_s(LevelBasedAssessment, \"99tk7DTVgFx8jeld1IhlgH0W00Y=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = LevelBasedAssessment;\nexport default LevelBasedAssessment;\nvar _c;\n$RefreshReg$(_c, \"LevelBasedAssessment\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useParams","useNavigate","axios","jsxDEV","_jsxDEV","LevelBasedAssessment","_s","classId","studentId","navigate","currentLevel","setCurrentLevel","isRecording","setIsRecording","transcript","setTranscript","expectedAnswer","setExpectedAnswer","accuracy","setAccuracy","showAccuracy","setShowAccuracy","error","setError","isSaving","setIsSaving","progress","setProgress","story","completed","poem","sentence","words","letter","recognitionRef","levels","id","name","description","startSpeechRecognition","window","recognition","webkitSpeechRecognition","current","continuous","interimResults","onresult","event","resultIndex","results","onerror","start","stopSpeechRecognition","stop","calculateAccuracy","expected","actual","console","log","cleanExpected","toLowerCase","trim","replace","cleanActual","expectedWords","split","filter","word","length","actualWords","matches","forEach","expectedWord","includes","partialMatch","some","actualWord","similarity","calculateSimilarity","Math","round","str1","str2","matrix","Array","fill","map","i","j","cost","min","distance","maxLength","max","handleEvaluate","calculatedAccuracy","levelName","prev","handleSave","currentLevelName","formattedProgress","assessmentData","type","levelNumber","date","Date","res","post","withCredentials","headers","data","err","_err$response","_err$response$data","response","msg","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","level","_progress$level$name$","value","onChange","e","target","rows","placeholder","style","width","disabled","_c","$RefreshReg$"],"sources":["C:/Users/asus/OneDrive/Desktop/autom/client/src/components/assessment/LevelBasedAssessment.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nconst LevelBasedAssessment = () => {\r\n  const { classId, studentId } = useParams();\r\n  const navigate = useNavigate();\r\n  const [currentLevel, setCurrentLevel] = useState(1);\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [transcript, setTranscript] = useState('');\r\n  const [expectedAnswer, setExpectedAnswer] = useState('');\r\n  const [accuracy, setAccuracy] = useState(null);\r\n  const [showAccuracy, setShowAccuracy] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [progress, setProgress] = useState({\r\n    story: { completed: false, accuracy: 0 },\r\n    poem: { completed: false, accuracy: 0 },\r\n    sentence: { completed: false, accuracy: 0 },\r\n    words: { completed: false, accuracy: 0 },\r\n    letter: { completed: false, accuracy: 0 }\r\n  });\r\n  const recognitionRef = useRef(null);\r\n\r\n  const levels = [\r\n    { id: 1, name: 'Story', description: 'Read a short story' },\r\n    { id: 2, name: 'Poem', description: 'Recite a poem' },\r\n    { id: 3, name: 'Sentence', description: 'Read a sentence' },\r\n    { id: 4, name: 'Words', description: 'Read individual words' },\r\n    { id: 5, name: 'Letter', description: 'Read individual letters' }\r\n  ];\r\n\r\n  // Speech Recognition Setup\r\n  const startSpeechRecognition = () => {\r\n    if ('webkitSpeechRecognition' in window) {\r\n      const recognition = new window.webkitSpeechRecognition();\r\n      recognitionRef.current = recognition;\r\n      recognition.continuous = true;\r\n      recognition.interimResults = true;\r\n\r\n      recognition.onresult = (event) => {\r\n        const current = event.resultIndex;\r\n        const transcript = event.results[current][0].transcript;\r\n        setTranscript(transcript);\r\n      };\r\n\r\n      recognition.onerror = (event) => {\r\n        setError('Speech recognition error: ' + event.error);\r\n      };\r\n\r\n      recognition.start();\r\n      setIsRecording(true);\r\n    } else {\r\n      setError('Speech recognition is not supported in your browser');\r\n    }\r\n  };\r\n\r\n  const stopSpeechRecognition = () => {\r\n    if (recognitionRef.current) {\r\n      recognitionRef.current.stop();\r\n      setIsRecording(false);\r\n    }\r\n  };\r\n\r\n  const calculateAccuracy = (expected, actual) => {\r\n    console.log('Calculating accuracy:', { expected, actual });\r\n    if (!expected || !actual) return 0;\r\n    \r\n    // Clean and normalize the texts\r\n    const cleanExpected = expected.toLowerCase().trim().replace(/[^a-z0-9\\s]/g, '');\r\n    const cleanActual = actual.toLowerCase().trim().replace(/[^a-z0-9\\s]/g, '');\r\n    \r\n    // Split into words and remove empty strings\r\n    const expectedWords = cleanExpected.split(/\\s+/).filter(word => word.length > 0);\r\n    const actualWords = cleanActual.split(/\\s+/).filter(word => word.length > 0);\r\n    \r\n    console.log('Cleaned expected words:', expectedWords);\r\n    console.log('Cleaned actual words:', actualWords);\r\n    \r\n    // Count matching words\r\n    let matches = 0;\r\n    expectedWords.forEach(expectedWord => {\r\n      // Check for exact matches first\r\n      if (actualWords.includes(expectedWord)) {\r\n        matches++;\r\n      } else {\r\n        // Check for partial matches\r\n        const partialMatch = actualWords.some(actualWord => {\r\n          const similarity = calculateSimilarity(expectedWord, actualWord);\r\n          return similarity > 0.8;\r\n        });\r\n        if (partialMatch) {\r\n          matches++;\r\n        }\r\n      }\r\n    });\r\n    \r\n    const accuracy = (matches / expectedWords.length) * 100;\r\n    console.log('Accuracy calculated:', accuracy);\r\n    return Math.round(accuracy);\r\n  };\r\n\r\n  const calculateSimilarity = (str1, str2) => {\r\n    if (str1.length === 0 || str2.length === 0) return 0;\r\n    \r\n    const matrix = Array(str1.length + 1).fill().map(() => \r\n      Array(str2.length + 1).fill(0)\r\n    );\r\n    \r\n    for (let i = 0; i <= str1.length; i++) {\r\n      matrix[i][0] = i;\r\n    }\r\n    for (let j = 0; j <= str2.length; j++) {\r\n      matrix[0][j] = j;\r\n    }\r\n    \r\n    for (let i = 1; i <= str1.length; i++) {\r\n      for (let j = 1; j <= str2.length; j++) {\r\n        const cost = str1[i - 1] === str2[j - 1] ? 0 : 1;\r\n        matrix[i][j] = Math.min(\r\n          matrix[i - 1][j] + 1,\r\n          matrix[i][j - 1] + 1,\r\n          matrix[i - 1][j - 1] + cost\r\n        );\r\n      }\r\n    }\r\n    \r\n    const distance = matrix[str1.length][str2.length];\r\n    const maxLength = Math.max(str1.length, str2.length);\r\n    return 1 - (distance / maxLength);\r\n  };\r\n\r\n  const handleEvaluate = () => {\r\n    console.log('Evaluating assessment...');\r\n    console.log('Expected Answer:', expectedAnswer);\r\n    console.log('Transcript:', transcript);\r\n    \r\n    if (!expectedAnswer || !transcript) {\r\n      setError('Please provide both expected answer and student response');\r\n      return;\r\n    }\r\n\r\n    const calculatedAccuracy = calculateAccuracy(expectedAnswer, transcript);\r\n    console.log('Setting accuracy:', calculatedAccuracy);\r\n    setAccuracy(calculatedAccuracy);\r\n    setShowAccuracy(true);\r\n    setError('');\r\n\r\n    // Update progress if accuracy is above threshold\r\n    if (calculatedAccuracy >= 33) {\r\n      const levelName = levels[currentLevel - 1].name.toLowerCase();\r\n      setProgress(prev => ({\r\n        ...prev,\r\n        [levelName]: { completed: true, accuracy: calculatedAccuracy }\r\n      }));\r\n\r\n      // Unlock next level if available\r\n      if (currentLevel < levels.length) {\r\n        setCurrentLevel(prev => prev + 1);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!accuracy && accuracy !== 0) {\r\n      setError('Please evaluate the assessment before saving');\r\n      return;\r\n    }\r\n\r\n    if (!expectedAnswer || !transcript) {\r\n      setError('Please provide both expected answer and student response');\r\n      return;\r\n    }\r\n\r\n    setIsSaving(true);\r\n    try {\r\n      // Get current level name\r\n      const currentLevelName = levels[currentLevel - 1].name;\r\n      \r\n      // Ensure progress data is properly formatted\r\n      const formattedProgress = {\r\n        story: progress.story || { completed: false, accuracy: 0 },\r\n        poem: progress.poem || { completed: false, accuracy: 0 },\r\n        sentence: progress.sentence || { completed: false, accuracy: 0 },\r\n        words: progress.words || { completed: false, accuracy: 0 },\r\n        letter: progress.letter || { completed: false, accuracy: 0 }\r\n      };\r\n\r\n      const assessmentData = {\r\n        type: 'level-based',\r\n        levelName: currentLevelName,\r\n        levelNumber: currentLevel,\r\n        expectedAnswer,\r\n        transcript,\r\n        accuracy,\r\n        currentLevel,\r\n        progress: formattedProgress,\r\n        date: new Date()\r\n      };\r\n      \r\n      console.log('Saving assessment with data:', assessmentData);\r\n      \r\n      const res = await axios.post(\r\n        `/api/classes/${classId}/students/${studentId}/assessment`,\r\n        assessmentData,\r\n        { \r\n          withCredentials: true,\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          }\r\n        }\r\n      );\r\n      \r\n      console.log('Assessment saved successfully:', res.data);\r\n      navigate(`/class/${classId}/student/${studentId}/assessments`);\r\n    } catch (err) {\r\n      console.error('Error saving assessment:', err);\r\n      setError(err.response?.data?.msg || 'Failed to save assessment');\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <div className=\"flex items-center justify-between mb-8\">\r\n          <h1 className=\"text-3xl font-bold\">Level-Based Assessment</h1>\r\n          <button\r\n            onClick={() => navigate(-1)}\r\n            className=\"px-4 py-2 text-gray-600 hover:text-gray-800\"\r\n          >\r\n            ← Back\r\n          </button>\r\n        </div>\r\n\r\n        {error && (\r\n          <div className=\"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded mb-4\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        {/* Level Progress */}\r\n        <div className=\"bg-white rounded-lg shadow-md p-6 mb-8\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">Level Progress</h2>\r\n          <div className=\"space-y-4\">\r\n            {levels.map((level) => (\r\n              <div\r\n                key={level.id}\r\n                className={`p-4 rounded-lg border ${\r\n                  level.id === currentLevel\r\n                    ? 'border-indigo-500 bg-indigo-50'\r\n                    : level.id < currentLevel\r\n                    ? 'border-green-500 bg-green-50'\r\n                    : 'border-gray-200 bg-gray-50'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <h3 className=\"font-medium\">{level.name}</h3>\r\n                    <p className=\"text-sm text-gray-600\">{level.description}</p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    {level.id < currentLevel ? (\r\n                      <span className=\"text-green-600\">Completed</span>\r\n                    ) : level.id === currentLevel ? (\r\n                      <span className=\"text-indigo-600\">Current Level</span>\r\n                    ) : (\r\n                      <span className=\"text-gray-500\">Locked</span>\r\n                    )}\r\n                    {progress[level.name.toLowerCase()]?.accuracy > 0 && (\r\n                      <div className=\"text-sm\">\r\n                        Accuracy: {progress[level.name.toLowerCase()].accuracy}%\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Current Level Assessment */}\r\n        <div className=\"bg-white rounded-lg shadow-md p-6 mb-8\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">\r\n            Level {currentLevel}: {levels[currentLevel - 1].name}\r\n          </h2>\r\n          \r\n          <div className=\"mb-6\">\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              Expected Answer\r\n            </label>\r\n            <textarea\r\n              value={expectedAnswer}\r\n              onChange={(e) => setExpectedAnswer(e.target.value)}\r\n              className=\"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\"\r\n              rows=\"3\"\r\n              placeholder=\"Enter the expected answer\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"mb-6\">\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              Student's Response\r\n            </label>\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n              <button\r\n                onClick={isRecording ? stopSpeechRecognition : startSpeechRecognition}\r\n                className={`px-4 py-2 rounded-md ${\r\n                  isRecording\r\n                    ? 'bg-red-600 hover:bg-red-700'\r\n                    : 'bg-indigo-600 hover:bg-indigo-700'\r\n                } text-white`}\r\n              >\r\n                {isRecording ? 'Stop Recording' : 'Start Recording'}\r\n              </button>\r\n              {isRecording && (\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"w-3 h-3 bg-red-600 rounded-full animate-pulse mr-2\"></div>\r\n                  <span className=\"text-sm text-gray-600\">Recording...</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n            <textarea\r\n              value={transcript}\r\n              onChange={(e) => setTranscript(e.target.value)}\r\n              className=\"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500\"\r\n              rows=\"3\"\r\n              placeholder=\"Student's response will appear here\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex justify-between items-center\">\r\n            <button\r\n              onClick={handleEvaluate}\r\n              className=\"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500\"\r\n            >\r\n              Evaluate Assessment\r\n            </button>\r\n            {showAccuracy && (\r\n              <div className=\"text-right\">\r\n                <p className=\"text-lg font-medium\">Accuracy: {accuracy}%</p>\r\n                <div className=\"w-32 bg-gray-200 rounded-full h-2.5 mt-1\">\r\n                  <div\r\n                    className=\"bg-indigo-600 h-2.5 rounded-full\"\r\n                    style={{ width: `${accuracy}%` }}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {showAccuracy && (\r\n          <div className=\"flex justify-end\">\r\n            <button\r\n              onClick={handleSave}\r\n              disabled={isSaving}\r\n              className={`px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 ${\r\n                isSaving ? 'opacity-50 cursor-not-allowed' : ''\r\n              }`}\r\n            >\r\n              {isSaving ? 'Saving...' : 'Save Assessment'}\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LevelBasedAssessment; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}